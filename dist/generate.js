"use strict";var _interopRequireDefault=require("@babel/runtime/helpers/interopRequireDefault");exports.__esModule=!0,exports.default=generate;var _async=_interopRequireDefault(require("async")),_fsExtra=_interopRequireDefault(require("fs-extra")),_path=_interopRequireDefault(require("path")),_mississippi=require("mississippi"),_lib=require("./lib");function generate(a,b){const c=_path.default.resolve(this.config.outdir,"lists"),d=b=>new _lib.KeystoneReader(a,b);_async.default.series([a=>_fsExtra.default.emptyDir(c,a),b=>_async.default.eachOf(a.lists,(a,b,e)=>{const f=_path.default.resolve(c,`${b}.js`);_fsExtra.default.ensureFileSync(f);const g=_fsExtra.default.createWriteStream(f),h=d(b);(0,_mississippi.pipe)(h,g,a=>{a&&console.error(a),h.destroy(),e(a)})},b),b=>(0,_lib.createTypeDefs)(a,b)],b)}